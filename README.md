# Space-detection

В данном репозитории представлены ссылки на  данные для обучения, веса модели и ноутбук который позволяет сделать TRAIN / INFERENCE для задачи определения пропущенных пробелов в запросах пользователей

Ссылка датасет: https://www.kaggle.com/datasets/pencilred/dataset-for-ru-query-space-detection
Ссылка на ноутбук: https://www.kaggle.com/code/pencilred/fine-tune-rubert-tiny-2-for-ru-query-space-detecti

**Подход к решению**

Задача восстановления пробелов была переформулирована как задача классификации токенов.

1. Текст без пробелов рассматривается как последовательность символов. Для каждого символа модель предсказывает одну из двух меток:
    *   NO_SPACE (0) - после этого символа пробел не нужен.
    *   SPACE (1) - после этого символа необходимо вставить пробел.

2.  В качестве основы была выбрана модель cointegrated/rubert-tiny2 из репозитория Hugging Face. Это компактная и эффективная версия BERT, предобученная на большом корпусе русских текстов

3.  Для обучения модели был собран разнообразный датасет  

Использовались открытые данные:
1. Описания объявлений товаров из соревнования на Kaggle - The Hunt for Prohibited Content от Авито (https://www.kaggle.com/competitions/avito-prohibited-content/code) 
2. Отзывы пользователей на товары (https://huggingface.co/datasets/ai-forever/ru-reviews-classification)
3. Корпус текстов русской поэзии (https://www.kaggle.com/datasets/greencools/russianpoetry)

Для повышения устойчивости модели к опечаткам 20% обучающих данных были аугментированы путем случайной вставки символов с помощью библиотеки nlpaug.

Из каждого источника было взято равное количество примеров, чтобы избежать смещения модели в сторону одного домена.

**Использование ноутбука**

Ноутбук имеет два режима работы, которые можно контролировать с помощью класса settings в первой ячейке:

-   Обучение  - запускает полный цикл подготовки данных, обучения и валидации модели. В конце выполняется инференс на тестовых данных и сохраняется файл submission.csv.
-  Инференс - пропускает все шаги, связанные с обучением. Загружает уже обученные веса модели  которая была обучена под задачу применяет их для предсказания на тестовом файле. Результат сохраняется в submission_inference.csv

**Среда и ресурсы**

-   Платформа: Обучение производилось в облачной среде Kaggle.
-   Ресурсы: 32 GB RAM, GPU NVIDIA P100.
-   Зависимости: Все зависимости актуальны для стандартного окружения Kaggle Notebooks.
-   Общее время обучения: ~3 часа.

